<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Escape the Wallpaper</title>
  <style>
    :root{
      --bg:#0d0f12;
      --card:#14181e;
      --ink:#e9eef6;
      --muted:#b9c4d6;
      --accent:#e6d84b;
      --danger:#ff6b6b;
      --ok:#59d98e;
      --line:#232a33;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius:16px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--ink);
      background:
        radial-gradient(1200px 700px at 20% 10%, rgba(230,216,75,.12), transparent 60%),
        radial-gradient(900px 600px at 80% 20%, rgba(89,217,142,.10), transparent 55%),
        radial-gradient(1100px 700px at 40% 90%, rgba(255,107,107,.08), transparent 60%),
        linear-gradient(180deg, #090a0c, var(--bg));
      min-height:100vh;
      padding:24px;
    }
    header{
      max-width:1100px;
      margin:0 auto 18px auto;
      display:flex;
      gap:14px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    h1{
      margin:0;
      font-size: clamp(22px, 3vw, 34px);
      letter-spacing:.2px;
    }
    .sub{
      margin-top:6px;
      color:var(--muted);
      max-width:720px;
      line-height:1.35;
    }
    .pillrow{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      margin-top:10px;
    }
    .pill{
      border:1px solid var(--line);
      background:rgba(20,24,30,.6);
      padding:8px 10px;
      border-radius:999px;
      color:var(--muted);
      font-size:13px;
      box-shadow: var(--shadow);
    }
    .wrap{
      max-width:1100px;
      margin:0 auto;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:18px;
    }
    @media (max-width: 920px){
      .wrap{grid-template-columns:1fr}
    }
    .panel{
      background:rgba(20,24,30,.78);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .panel h2{
      margin:0;
      padding:14px 16px;
      border-bottom:1px solid var(--line);
      font-size:16px;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .room{
      padding:16px;
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap:14px;
    }
    @media (max-width:520px){
      .room{grid-template-columns:1fr}
    }
    button.obj{
      text-align:left;
      padding:14px 14px;
      border-radius:14px;
      border:1px solid var(--line);
      background:
        linear-gradient(180deg, rgba(230,216,75,.12), transparent 35%),
        rgba(13,15,18,.65);
      color:var(--ink);
      cursor:pointer;
      transition: transform .08s ease, border-color .12s ease, background .12s ease;
      min-height:92px;
      position:relative;
    }
    button.obj:hover{
      transform: translateY(-1px);
      border-color: rgba(230,216,75,.45);
      background:
        linear-gradient(180deg, rgba(230,216,75,.16), transparent 42%),
        rgba(13,15,18,.72);
    }
    button.obj:active{
      transform: translateY(0px);
    }
    .obj .name{
      font-weight:700;
      margin-bottom:6px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .obj .hint{
      color:var(--muted);
      font-size:13px;
      line-height:1.35;
    }
    .badge{
      position:absolute;
      top:10px;
      right:10px;
      font-size:12px;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid var(--line);
      color:var(--muted);
      background:rgba(20,24,30,.7);
    }
    .side{
      padding:14px 16px 16px 16px;
    }
    .inventory{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:10px;
    }
    .token{
      border:1px solid var(--line);
      background: rgba(13,15,18,.55);
      border-radius:999px;
      padding:7px 10px;
      font-size:13px;
      color:var(--muted);
      display:flex;
      align-items:center;
      gap:8px;
    }
    .token b{
      color:var(--ink);
      font-family:var(--mono);
      font-weight:700;
      letter-spacing:.2px;
    }
    .log{
      margin-top:12px;
      border:1px solid var(--line);
      border-radius:14px;
      background: rgba(13,15,18,.55);
      padding:12px;
      min-height:128px;
      color:var(--muted);
      line-height:1.35;
      font-size:14px;
    }
    .lockbox{
      margin-top:14px;
      border-top:1px solid var(--line);
      padding-top:14px;
    }
    .lockrow{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      margin-top:8px;
    }
    input.code{
      width:140px;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--line);
      background: rgba(7,8,10,.75);
      color:var(--ink);
      font-family:var(--mono);
      font-size:16px;
      letter-spacing:3px;
      outline:none;
    }
    .btn{
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--line);
      background: rgba(230,216,75,.14);
      color:var(--ink);
      cursor:pointer;
      font-weight:700;
      transition: transform .08s ease, border-color .12s ease, background .12s ease;
    }
    .btn:hover{
      border-color: rgba(230,216,75,.45);
      background: rgba(230,216,75,.18);
      transform: translateY(-1px);
    }
    .btn:active{transform: translateY(0px);}
    .msg{
      margin-top:10px;
      font-size:14px;
      color:var(--muted);
    }
    .msg.ok{color:var(--ok)}
    .msg.bad{color:var(--danger)}
    footer{
      max-width:1100px;
      margin:14px auto 0 auto;
      color:egba(185,196,214,.85);
      font-size:12px;
      line-height:1.35;
    }
    .tiny{
      font-family:var(--mono);
      font-size:12px;
      color:rgba(185,196,214,.85);
    }
   /* Full Asylum Collapse */
@keyframes flicker {
    0%, 70%, 100% { filter: brightness(1) contrast(1); }
    75% { filter: brightness(0.6) contrast(1.4); }
    78% { filter: brightness(1.3) contrast(0.8); }
    82% { filter: brightness(0.7) contrast(1.2); }

}/* Subtle unstable shake */
@keyframes shake {
  0%   { transform: translate(0px, 0px); }
  10%  { transform: translate(-1px, 1px); }
  20%  { transform: translate(1px, -1px); }
  30%  { transform: translate(-1px, -1px); }
  40%  { transform: translate(1px, 1px); }
  50%  { transform: translate(-1px, 0px); }
  60%  { transform: translate(1px, 0px); }
  70%  { transform: translate(0px, -1px); }
  80%  { transform: translate(0px, 1px); }
  90%  { transform: translate(-1px, 1px); }
  100% { transform: translate(0px, 0px); }
}

body {
    animation:
        flicker 12s infinite ease-in-out,
        shake 12s infinite;
}

  </style>
</head>

<body>
  <header>
    <div>
      <h1>üü° Escape the Wallpaper</h1>
      <div class="sub">
        You are ‚Äúrecovering‚Äù in a room designed to help you rest‚Ä¶ by stripping you of agency.
        Click objects to uncover clues. Collect four digits. Enter the code to unlock the door.
      </div>
      <div class="pillrow">
        <div class="pill">Goal: find <b>4 digits</b> ‚Üí unlock the door</div>
        <div class="pill">Theme: confinement ‚Ä¢ voice ‚Ä¢ control ‚Ä¢ ‚Äúcare‚Äù</div>
        <div class="pill">Works offline</div>
      </div>
    </div>
    <div class="pill tiny">Teacher tip: Press Refresh to reset the game.</div>
  </header>

  <main class="wrap">
    <section class="panel" aria-label="Room">
      <h2>üèöÔ∏è The Room</h2>
      <div class="room">
        <button class="obj" id="objBed" type="button">
          <div class="badge" id="bedBadge">Unsearched</div>
          <div class="name">üõèÔ∏è The Bed</div>
          <div class="hint">It won‚Äôt move. Almost like it was‚Ä¶ installed.</div>
        </button>

        <button class="obj" id="objBars" type="button">
          <div class="badge" id="barsBadge">Unsearched</div>
          <div class="name">ü™ü The Windows</div>
          <div class="hint">Bright outside. Inside feels dim. The bars feel personal.</div>
        </button>

        <button class="obj" id="objJournal" type="button">
          <div class="badge" id="journalBadge">Unsearched</div>
          <div class="name">üìì The Hidden Journal</div>
          <div class="hint">You aren‚Äôt supposed to write. So of course you do.</div>
        </button>

        <button class="obj" id="objPaper" type="button">
          <div class="badge" id="paperBadge">Unsearched</div>
          <div class="name">üü® The Wallpaper</div>
          <div class="hint">The pattern seems to move when you stop looking directly at it.</div>
        </button>

        <button class="obj" id="objHusband" type="button">
          <div class="badge" id="husbandBadge">Unsearched</div>
          <div class="name">ü©∫ The Husband-Doctor</div>
          <div class="hint">His kindness has rules attached. His rules have teeth.</div>
        </button>

        <button class="obj" id="objDoor" type="button">
          <div class="badge" id="doorBadge">Locked</div>
          <div class="name">üö™ The Door</div>
          <div class="hint">A keypad. Four digits. Your exit depends on reading the room.</div>
        </button>
      </div>
    </section>

    <aside class="panel" aria-label="Clues and lock">
      <h2>üß© Clues & Lock</h2>
      <div class="side">
        <div><b>Inventory:</b> collect digits as you investigate.</div>
        <div class="inventory" id="inv"></div>

        <div class="log" id="log">
          <div><b>Room Log</b></div>
          <div id="logText" style="margin-top:8px;">
            Click an object to begin. You‚Äôre ‚Äúresting.‚Äù You feel yourself disappearing.
          </div>
        </div>

        <div class="lockbox">
          <div><b>Door Keypad</b></div>
          <div class="tiny">Enter the 4-digit code you discovered.</div>
          <div class="lockrow">
            <input class="code" id="codeInput" inputmode="numeric" maxlength="4" placeholder="____" aria-label="4 digit code" />
            <button class="btn" id="tryBtn" type="button">Unlock</button>
            <button class="btn" id="hintBtn" type="button">Need a hint</button>
          </div>
          <div class="msg" id="msg"></div>
        </div>
      </div>
    </aside>
  </main>

  <footer>
    <div class="tiny">
      Directions: Explore the room and unlock the door.
      After you ‚Äúescape,‚Äù answer the following question in your notebook: Is the ending of <i>The Yellow Wallpaper</i> tragic, liberating, or both?
    </div>
  </footer>

  <script>
    // ===== Game State =====
    const state = {
      digits: {},     // e.g., { bed: "1", bars:"8", journal:"9", paper:"2" }
      found: new Set(),
      solved: false
    };

    // The correct code is built from the digits revealed by 4 core objects
    // You can change these digits if you want a new code.
    const DIGITS = {
      bed:    { digit: "1", label: "Bed", icon: "üõèÔ∏è" },
      bars:   { digit: "8", label: "Windows", icon: "ü™ü" },
      journal:{ digit: "9", label: "Journal", icon: "üìì" },
      paper:  { digit: "2", label: "Wallpaper", icon: "üü®" }
    };

    // Code order (teaches: trace the arc of control -> voice -> obsession -> rupture)
    // 1) Bed (confinement) 2) Windows (surveillance) 3) Journal (voice) 4) Wallpaper (breakthrough)
    const CODE_ORDER = ["bed","bars","journal","paper"];
    const ANSWER = CODE_ORDER.map(k => DIGITS[k].digit).join("");

    // ===== Helpers =====
    const $ = (id) => document.getElementById(id);

    function setLog(text){
      $("logText").innerHTML = text;
    }

    function setBadge(which, text){
      $(which + "Badge").textContent = text;
    }

    function addDigit(key){
      if(state.found.has(key)) return;
      state.found.add(key);
      state.digits[key] = DIGITS[key].digit;
      renderInventory();
    }

    function renderInventory(){
      const inv = $("inv");
      inv.innerHTML = "";

      const keys = Object.keys(DIGITS);
      for(const k of keys){
        const got = state.found.has(k);
        const chip = document.createElement("div");
        chip.className = "token";
        chip.innerHTML = `${DIGITS[k].icon} ${DIGITS[k].label}: <b>${got ? DIGITS[k].digit : "?"}</b>`;
        inv.appendChild(chip);
      }
    }

    function setMessage(text, kind=""){
      const el = $("msg");
      el.className = "msg " + kind;
      el.textContent = text;
    }

    function onlyDigits(str){
      return (str || "").replace(/\D/g,"").slice(0,4);
    }

    // ===== Object Events =====
    $("objBed").addEventListener("click", () => {
      setBadge("bed","Searched");
      addDigit("bed");
      setLog(`
        <b>The bed is nailed down.</b><br><br>
        You tug. Nothing. A bed that cannot move turns rest into captivity.<br><br>
        <span class="tiny">You find a carved digit under the frame: <b>${DIGITS.bed.digit}</b></span><br><br>
        Question: When does ‚Äúcomfort‚Äù become a tool of control?
      `);
      setMessage("Clue found: the bed yields a digit.", "ok");
    });

    $("objBars").addEventListener("click", () => {
      setBadge("bars","Searched");
      addDigit("bars");
      setLog(`
        <b>The windows are barred.</b><br><br>
        From outside, it‚Äôs a nursery. From inside, it‚Äôs a cage.<br><br>
        <span class="tiny">A digit is scratched into the paint: <b>${DIGITS.bars.digit}</b></span><br><br>
        Question: Who decides what ‚Äúsafety‚Äù looks like?
      `);
      setMessage("Clue found: the windows yield a digit.", "ok");
    });

    $("objJournal").addEventListener("click", () => {
      setBadge("journal","Searched");
      addDigit("journal");
      setLog(`
        <b>A journal is hidden beneath a loose floorboard.</b><br><br>
        The handwriting starts neat, then becomes jagged. The voice grows louder as the rules tighten.<br><br>
        <span class="tiny">Inside the back cover: <b>${DIGITS.journal.digit}</b></span><br><br>
        Question: What happens to a mind when it has no authorized outlet?
      `);
      setMessage("Clue found: the journal yields a digit.", "ok");
    });

    $("objPaper").addEventListener("click", () => {
      setBadge("paper","Searched");
      addDigit("paper");
      setLog(`
        <b>The wallpaper pattern won‚Äôt stay still.</b><br><br>
        The front pattern feels like a set of rules. Behind it, something moves. A figure. A woman. A self.<br><br>
        <span class="tiny">Behind a torn flap: <b>${DIGITS.paper.digit}</b></span><br><br>
        Question: Is tearing the paper down a breakdown‚Ä¶ or a jailbreak?
      `);
      setMessage("Clue found: the wallpaper yields a digit.", "ok");
    });

    $("objHusband").addEventListener("click", () => {
      setBadge("husband","Searched");
      setLog(`
        <b>He smiles like a lock clicking shut.</b><br><br>
        ‚ÄúYou mustn‚Äôt write.‚Äù ‚ÄúYou must rest.‚Äù ‚ÄúI know what‚Äôs best.‚Äù<br><br>
        He calls it love. He calls it medicine. Either way, it makes your world smaller.<br><br>
        Question: How can care become paternalism?
      `);
      setMessage("No digit here. But you learned the room‚Äôs power structure.", "");
    });

    $("objDoor").addEventListener("click", () => {
      setLog(`
        <b>The door has a keypad.</b><br><br>
        You need four digits. You won‚Äôt find them by ‚Äúresting.‚Äù<br><br>
        Tip: Search the bed, windows, journal, and wallpaper. Then enter the code.
      `);
      setMessage("The door is locked. Find all four digits.", "");
    });

    // ===== Unlocking =====
    $("codeInput").addEventListener("input", (e) => {
      e.target.value = onlyDigits(e.target.value);
      if(e.target.value.length === 4) setMessage("Press Unlock.", "");
    });

    $("tryBtn").addEventListener("click", () => {
      if(state.solved){
        setMessage("Already unlocked. Refresh the page to replay.", "ok");
        return;
      }
      const typed = onlyDigits($("codeInput").value);
      if(typed.length < 4){
        setMessage("Enter 4 digits.", "bad");
        return;
      }

      if(typed === ANSWER){
        state.solved = true;
        setBadge("door","Unlocked");
        setMessage("‚úÖ UNLOCKED. You escaped the room. Now explain what each clue symbolizes.", "ok");
        setLog(`
          <b>The door opens.</b><br><br>
          Air hits your face like a new idea.<br><br>
          <b>Reflection prompt:</b> The narrator in <i>The Yellow Wallpaper</i> ‚Äúescapes‚Äù by tearing the paper down.
          Is that ending tragic, liberating, or both? Support your answer with evidence from the room.
        `);
      } else {
        setMessage("‚ùå Wrong code. Re-check your digits and the order.", "bad");
      }
    });

    $("hintBtn").addEventListener("click", () => {
      const foundCount = state.found.size;
      if(foundCount < 4){
        setMessage(`Hint: You still need digits. Search Bed, Windows, Journal, Wallpaper. (${foundCount}/4 found)`, "");
        return;
      }
      setMessage(`Hint: Order matters. Think: confinement ‚Üí surveillance ‚Üí voice ‚Üí rupture.`, "");
    });

    // Initialize inventory
    renderInventory();
  </script>
</body>
</html>
